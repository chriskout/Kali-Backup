This is pretty simple buffer overflow problem, see code comments for more help.
